(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-9234"],{"+cae":function(e,t,a){"use strict";a.r(t);var r=a("14Xm"),l=a.n(r),s=a("D3Ub"),o=a.n(s),i=a("7Qib"),n={data:function(){return{tableData:[],page:{pageSize:10,total:0,currentPage:1},switchForm:!1,showDetails:!1,order:{},panelTitle:"",auditorName:"",d:{},dialogFormVisible:!1}},filters:{payFilter:function(e){switch(e){case"ONLINEL":return"success";case"OFFLINE":return"warning"}},formatPay:function(e){switch(e){case"ONLINEL":return"线上充值";case"OFFLINE":return"人工打款"}},statusFilter:function(e){return e?"success":"danger"},formatStatus:function(e){return e?"已通过":"未审批"}},created:function(){this.getDataList(),this.getAuditUser()},methods:{getDataList:function(){var e=this;return o()(l.a.mark(function t(){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._fetch("/auditOrder/list?limit=10&page=1",{method:"GET"});case 2:0===(a=t.sent).code?(e.tableData=a.page.list,e.page.total=a.page.totalCount,e.page.pageSize=a.page.pageSize):console.log(a.msg);case 4:case"end":return t.stop()}},t,e)}))()},auditHandle:function(e,t){this.order=t,this.order.userName=this.auditorName,this.order.taskId=this.order.id,this.order.smsStatus="",this.switchForm=!0,this.panelTitle="回购单审批"},getAuditUser:function(){var e=this;return o()(l.a.mark(function t(){var a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._fetch("/auditOrder/sysUser",{method:"GET"});case 2:a=t.sent,e.auditorName=a.sysUserAudit.auditorName;case 4:case"end":return t.stop()}},t,e)}))()},handleDetails:function(e,t){this.showDetails=!0,this.switchForm=!0;var a="?subNumber="+t.orderNo+"&mall="+t.mall;this.getOrderInfo(a)},getOrderInfo:function(e){var t=this;return o()(l.a.mark(function a(){return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t._fetch("/auditOrder/detail"+e,{method:"GET"});case 2:t.d=a.sent;case 3:case"end":return a.stop()}},a,t)}))()},onSubmit:function(){this.dialogFormVisible=!0},addAudit:function(){var e=this;return o()(l.a.mark(function t(){var a,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("OFFLINE"!==e.order.payTYpe&&"false"!==e.order.approvalStatus){t.next=8;break}return e.order.type="ack",t.next=4,e._fetch("//auditOrder/check",{method:"POST",body:e.order});case 4:0===(a=t.sent).code?(e.$message("操作成功"),e.query(),e.switchForm=!1):setTimeout(function(){e.$message(a.msg),e.switchForm=!1},1e3),t.next=17;break;case 8:if("ONLINEL"!==e.order.payTYpe){t.next=16;break}return e.order.type="apply",t.next=12,e._fetch("//auditOrder/check",{method:"POST",body:e.order});case 12:0===(r=t.sent).code?(e.order.applyBankSerialOrderNo=r.data.data.applyBankSerialOrderNo,e.switchForm=!1,e.order.smsCode="",e.order.traPwd=""):setTimeout(function(){e.$message(r.msg)},1e3),t.next=17;break;case 16:return t.abrupt("return");case 17:case"end":return t.stop()}},t,e)}))()},fillAuditPwd:function(){var e=this;return o()(l.a.mark(function t(){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.validator()){t.next=2;break}return t.abrupt("return");case 2:e.addAudit();case 3:case"end":return t.stop()}},t,e)}))()},reback:function(){this.switchForm=!1},rebackDetails:function(){this.showDetails=!1,this.switchForm=!1},handleSizeChange:function(e){var t=this;return o()(l.a.mark(function a(){var r;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t._fetch("/auditOrder/list?limit="+e+"&page="+t.page.currentPage,{method:"GET"});case 2:r=a.sent,t.tableData=r.page.list,t.page.pageSize=e;case 5:case"end":return a.stop()}},a,t)}))()},handleCurrentChange:function(e){var t=this;return o()(l.a.mark(function a(){var r;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t._fetch("/auditOrder/list?limit="+t.page.pageSize+"&page="+e,{method:"GET"});case 2:r=a.sent,t.tableData=r.page.list,t.page.currentPage=e;case 5:case"end":return a.stop()}},a,t)}))()},validator:function(){if(Object(i.g)(this.order.userName))return this.$message("审批用户名不能为空"),!0;if(Object(i.g)(this.order.taskId))return this.$message("审核订单ID不能为空"),!0;if(Object(i.g)(this.order.approvalStatus))return this.$message("审核意见不能为空"),!0;if(Object(i.g)(this.order.amt))return this.$message("回购金额不能为空"),!0;if(Object(i.g)(this.order.requestNo))return this.$message("回购单号不能为空"),!0;if(Object(i.g)(this.order.orderNo))return this.$message("订单号不能为空"),!0;if(Object(i.g)(this.order.productName))return this.$message("产品名称不能为空"),!0;if("ACTIVE"===this.order.smsStatus){if(Object(i.g)(this.order.smsCode))return this.$message("短信验证码不能为空"),!0}else if(Object(i.g)(this.order.traPwd))return this.$message("审批密码不能为空"),!0;return Object(i.g)(this.order.mall)?(this.$message("商城名称不能为空"),!0):void 0},rowClass:function(){return"text-align:center"}}},d=(a("Rj8E"),a("KHd+")),c=Object(d.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-container"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.switchForm,expression:"!switchForm"}],staticClass:"show-box"},[a("div",{staticClass:"tb-box"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-style":e.rowClass,border:"","max-height":"780"}},[a("el-table-column",{attrs:{type:"index",width:"40",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"审核订单ID",align:"left",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"requestNo",label:"请求编号",align:"left",width:"250"}}),e._v(" "),a("el-table-column",{attrs:{prop:"orderNo",label:"订单号",align:"left",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"productName",label:"产品名称",align:"left",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"amt",label:"回购金额",align:"left",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"purchasPrice",label:"购买总金额",align:"left",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"bankAccountName",label:"账号行名称",align:"left",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{prop:"bankAccountNo",label:"银行卡号",align:"left",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"branchBankAccountName",label:"账号分行名称",align:"left",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"payTYpe",label:"支付类型",align:"left",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e._f("payFilter")(t.row.payTYpe)}},[e._v(e._s(e._f("formatPay")(t.row.payTYpe)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"loginCode",label:"用户标识",align:"left",width:"250","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"mall",label:"商城名称",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{prop:"applyUser",label:"审批发起人",align:"left",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"审批组名",align:"left",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"applyStatus",label:"审批状态",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e._f("statusFilter")(t.row.applyStatus)}},[e._v(e._s(e._f("formatStatus")(t.row.applyStatus)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"applyTime",label:"审核时间",align:"center",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",align:"center",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){e.auditHandle(t.$index,t.row)}}},[e._v("审批")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.handleDetails(t.$index,t.row)}}},[e._v("订单详情")])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.page.currentPage,"page-sizes":[10,30,50],"page-size":e.page.pageSize,total:e.page.total,layout:"total, sizes, prev, pager, next, jumper",background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.switchForm,expression:"switchForm"}],staticClass:"form-section"},[a("div",{staticClass:"panel",domProps:{innerHTML:e._s(e.panelTitle)}}),e._v(" "),a("div",{staticClass:"form-container"},[a("el-form",{ref:"form",attrs:{model:e.order,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"审批用户名"}},[a("el-input",{attrs:{placeholder:"审批用户名",disabled:""},model:{value:e.order.userName,callback:function(t){e.$set(e.order,"userName",t)},expression:"order.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"审核订单ID"}},[a("el-input",{attrs:{placeholder:"审核订单ID",disabled:""},model:{value:e.order.id,callback:function(t){e.$set(e.order,"id",t)},expression:"order.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"回购金额"}},[a("el-input",{attrs:{placeholder:"回购金额",disabled:""},model:{value:e.order.amt,callback:function(t){e.$set(e.order,"amt",t)},expression:"order.amt"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"回购单号"}},[a("el-input",{attrs:{placeholder:"回购单号",disabled:""},model:{value:e.order.requestNo,callback:function(t){e.$set(e.order,"requestNo",t)},expression:"order.requestNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"订单号"}},[a("el-input",{attrs:{placeholder:"订单号",disabled:""},model:{value:e.order.orderNo,callback:function(t){e.$set(e.order,"orderNo",t)},expression:"order.orderNo"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"产品名称"}},[a("el-input",{attrs:{placeholder:"产品名称",disabled:""},model:{value:e.order.productName,callback:function(t){e.$set(e.order,"productName",t)},expression:"order.productName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"商城名称"}},[a("el-input",{attrs:{placeholder:"商城名称",disabled:""},model:{value:e.order.mall,callback:function(t){e.$set(e.order,"mall",t)},expression:"order.mall"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注信息"}},[a("el-input",{attrs:{type:"textarea",placeholder:"备注信息"},model:{value:e.order.result,callback:function(t){e.$set(e.order,"result",t)},expression:"order.result"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"确认方式"}},[a("el-radio-group",{model:{value:e.order.smsStatus,callback:function(t){e.$set(e.order,"smsStatus",t)},expression:"order.smsStatus"}},[a("el-radio",{attrs:{label:""}},[e._v("审批密码")]),e._v(" "),a("el-radio",{attrs:{label:"ACTIVE"}},[e._v("短信验证码")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"审核意见"}},[a("el-radio-group",{model:{value:e.order.approvalStatus,callback:function(t){e.$set(e.order,"approvalStatus",t)},expression:"order.approvalStatus"}},[a("el-radio",{attrs:{label:"true"}},[e._v("同意")]),e._v(" "),a("el-radio",{attrs:{label:"false"}},[e._v("驳回")])],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:e.reback}},[e._v("返回")])],1)],1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:"审批密码",visible:e.dialogFormVisible,width:"20%",top:"30vh",center:""},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{staticClass:"alertbox",attrs:{model:e.order}},[a("el-form-item",{attrs:{label:"订单号","label-width":"80px"}},[a("el-input",{attrs:{placeholder:"请输入审批密码",onkeyup:"value=value.replace(/[^\\w\\.\\/]/ig,'')"},model:{value:e.order.orderNo,callback:function(t){e.$set(e.order,"orderNo",t)},expression:"order.orderNo"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:""==e.order.smsStatus,expression:"order.smsStatus == ''"}],attrs:{label:"审批密码","label-width":"80px"}},[a("el-input",{model:{value:e.order.traPwd,callback:function(t){e.$set(e.order,"traPwd",t)},expression:"order.traPwd"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"ACTIVE"==e.order.smsStatus,expression:"order.smsStatus == 'ACTIVE'"}],attrs:{label:"验证码","label-width":"60px",placeholder:"请输入短信验证码"}},[a("el-input",{model:{value:e.order.smsCode,callback:function(t){e.$set(e.order,"smsCode",t)},expression:"order.smsCode"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.fillAuditPwd}},[e._v("确 定")])],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showDetails,expression:"showDetails"}],staticClass:"wrap-box"},[a("div",{staticClass:"form-section form-details"},[a("div",{staticClass:"panel"},[a("span",[e._v("订单详情")]),e._v(" "),a("el-button",{attrs:{type:"warning",size:"small"},on:{click:e.rebackDetails}},[e._v("返回")])],1),e._v(" "),a("div",{staticClass:"form-container"},[a("el-form",{attrs:{"label-position":"right","label-width":"120px",model:e.d}},[a("el-form-item",{attrs:{label:"订购ID"}},[a("el-input",{attrs:{disabled:"",placeholder:"订购ID"},model:{value:e.d.subId,callback:function(t){e.$set(e.d,"subId",t)},expression:"d.subId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"订购流水号"}},[a("el-input",{attrs:{disabled:"",placeholder:"订购流水号"},model:{value:e.d.subNumber,callback:function(t){e.$set(e.d,"subNumber",t)},expression:"d.subNumber"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"产品名称"}},[a("el-input",{attrs:{disabled:"",placeholder:"产品名称"},model:{value:e.d.prodName,callback:function(t){e.$set(e.d,"prodName",t)},expression:"d.prodName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"订单商品总数"}},[a("el-input",{attrs:{disabled:"",placeholder:"订单商品总数"},model:{value:e.d.productNums,callback:function(t){e.$set(e.d,"productNums",t)},expression:"d.productNums"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"订单类型"}},[a("el-input",{attrs:{disabled:"",placeholder:"订单类型"},model:{value:e.d.subType,callback:function(t){e.$set(e.d,"subType",t)},expression:"d.subType"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"订购用户名称"}},[a("el-input",{attrs:{disabled:"",placeholder:"订购用户名称"},model:{value:e.d.userName,callback:function(t){e.$set(e.d,"userName",t)},expression:"d.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"服务商编号"}},[a("el-input",{attrs:{disabled:"",placeholder:"服务商编号"},model:{value:e.d.serverNum,callback:function(t){e.$set(e.d,"serverNum",t)},expression:"d.serverNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"总值"}},[a("el-input",{attrs:{disabled:"",placeholder:"总值"},model:{value:e.d.total,callback:function(t){e.$set(e.d,"total",t)},expression:"d.total"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"实际总值"}},[a("el-input",{attrs:{disabled:"",placeholder:"实际总值"},model:{value:e.d.actualTotal,callback:function(t){e.$set(e.d,"actualTotal",t)},expression:"d.actualTotal"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"使用积分"}},[a("el-input",{attrs:{disabled:"",placeholder:"使用积分"},model:{value:e.d.score,callback:function(t){e.$set(e.d,"score",t)},expression:"d.score"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"优惠总金额"}},[a("el-input",{attrs:{disabled:"",placeholder:"优惠总金额"},model:{value:e.d.discountPrice,callback:function(t){e.$set(e.d,"discountPrice",t)},expression:"d.discountPrice"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"退差价金额"}},[a("el-input",{attrs:{disabled:"",placeholder:"退差价金额"},model:{value:e.d.priceRefund,callback:function(t){e.$set(e.d,"priceRefund",t)},expression:"d.priceRefund"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"订购时间"}},[a("el-input",{attrs:{disabled:"",placeholder:"订购时间"},model:{value:e.d.subDate,callback:function(t){e.$set(e.d,"subDate",t)},expression:"d.subDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"购买时间"}},[a("el-input",{attrs:{disabled:"",placeholder:"购买时间"},model:{value:e.d.payDate,callback:function(t){e.$set(e.d,"payDate",t)},expression:"d.payDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"完成时间"}},[a("el-input",{attrs:{disabled:"",placeholder:"完成时间"},model:{value:e.d.finallyDate,callback:function(t){e.$set(e.d,"finallyDate",t)},expression:"d.finallyDate"}})],1)],1)],1)])])],1)},[],!1,null,"538c228e",null);c.options.__file="auditOrder.vue";t.default=c.exports},Rj8E:function(e,t,a){"use strict";var r=a("sXtf");a.n(r).a},sXtf:function(e,t,a){}}]);