(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7f33"],{ISdA:function(e,t,n){"use strict";n.r(t);var i=n("m1cH"),a=n.n(i),l=n("14Xm"),s=n.n(l),o=n("D3Ub"),r=n.n(o),u=n("Kw5r"),c=n("7Qib"),d={data:function(){return{radio:!1,menuData:[],dealedData:[],tableListData:[],foldList:[],multipleSelection:[],loading:!0,switchForm:!1,dialogTableVisible:!1,menu:{type:"1"},panelTitle:"",defaultProps:{children:"children",label:"name"},treeData:[],data:{},delTip:!1}},computed:{foldAllList:function(){return this.tableListData.map(function(e){return e.__identity})}},created:function(){this.getMenuList(),this.getMenuTree()},methods:{hasPermission:function(e){return Object(c.f)(e)},initData:function(){this.dealedData=Object(c.d)(this.menuData),console.log(this.dealedData),this.tableListData=this.formatConversion([],this.dealedData),this.foldList=this.foldAllList},add:function(){this.panelTitle="新增菜单",this.switchForm=!0,this.menu={parentName:null,parentId:0,type:"1",orderNum:0}},update:function(){this.multipleSelection.menuId?(this.panelTitle="菜单信息更改",this.switchForm=!0,this.getMenuInfo()):this.$message("请选择一条记录")},del:function(){this.multipleSelection.menuId?this.delTip=!0:this.$message("请选择一条记录")},delConfirm:function(){var e=this;return r()(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._fetch("/sys/menu/delete",{method:"POST",body:e.menu.menuId});case 2:0===(n=t.sent).code?(e.$message("操作成功"),e.getMenuList(),e.delTip=!1):(e.$message(n.msg),e.delTip=!1);case 4:case"end":return t.stop()}},t,e)}))()},toggleFoldingStatus:function(e){this.foldList.includes(e.__identity)?this.foldList.splice(this.foldList.indexOf(e.__identity),1):this.foldList.push(e.__identity)},toggleDisplayTr:function(e){for(var t=e.row,n=(e.index,0);n<this.foldList.length;n++){var i=this.foldList[n];if(t.__family.includes(i)&&t.__identity!==i)return"display:none;"}return""},toggleFoldingClass:function(e){return null==e.Children?"permission_placeholder":-1===this.foldList.indexOf(e.__identity)?"iconfont icon-liebiaoshouqi_":"iconfont icon-liebiaozhankaitianjia_"},formatConversion:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"x";return t.length>0&&t.map(function(t,o){u.default.set(t,"__level",n),u.default.set(t,"__family",[].concat(a()(l),[s+"_"+o])),u.default.set(t,"__identity",s+"_"+o),e.push(t),t.Children&&t.Children.length>0&&i.formatConversion(e,t.Children,n+1,[].concat(a()(l),[s+"_"+o]),s+"_"+o)}),e},onSubmit:function(){if(!this.validator()){var e=null==this.menu.menuId?"/sys/menu/save":"/sys/menu/update";this.addUser(e)}},addUser:function(e){var t=this;return r()(s.a.mark(function n(){var i;return s.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t._fetch(e,{method:"POST",body:t.menu});case 2:0===(i=n.sent).code?(t.$message("操作成功"),t.getMenuList(),t.switchForm=!1):t.$message(i.msg);case 4:case"end":return n.stop()}},n,t)}))()},reback:function(){this.switchForm=!1},getMenuList:function(){var e=this;return r()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._fetch("/sys/menu/list",{method:"GET"});case 2:e.menuData=t.sent,e.initData();case 4:case"end":return t.stop()}},t,e)}))()},getMenuTree:function(){var e=this;return r()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._fetch("/sys/menu/select",{method:"GET"});case 2:e.data=t.sent;case 3:case"end":return t.stop()}},t,e)}))()},getMenuInfo:function(){var e=this;return r()(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._fetch("/sys/menu/info/"+e.menu.menuId,{method:"GET"});case 2:n=t.sent,e.menu=n.menu,e.menu.type=n.menu.type.toString(),e.data.menuList.forEach(function(t){if(e.menu.parentId==t.menuId)return e.menu.parentName=t.name}),console.log(e.menu.parentName);case 7:case"end":return t.stop()}},t,e)}))()},showMenuTree:function(){this.dialogTableVisible=!0,this.treeData=this.transform(this.data)},handleNodeClick:function(e){console.log(e),this.menu.parentName=e.name,this.menu.parentId=e.menuId},getCurrentRow:function(e){this.multipleSelection=e,this.menu=e,this.menu.menuId=e.menuId},transform:function(e){var t=e.menuList,n=[];return t.forEach(function(e){0==e.parentId&&(e.icon="folder",n.push(e))}),n.map(function(e){e.children=[],t.forEach(function(t){t.parentId==e.menuId&&(t.icon="folder",e.children.push(t))})}),n.map(function(e){e.children.map(function(e){e.children=[],t.forEach(function(t){t.parentId==e.menuId&&(t.icon="file",e.children.push(t))})})}),n},validator:function(){return Object(c.g)(this.menu.name)?(this.$message("菜单名称不能为空"),!0):1===this.menu.type&&Object(c.g)(this.menu.url)?(this.$message("菜单URL不能为空"),!0):void 0},rowClass:function(){return"text-align:center"}}},m=(n("o5AK"),n("KHd+")),p=Object(m.a)(d,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page-container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.switchForm,expression:"!switchForm"}],staticClass:"show-box"},[n("div",{staticClass:"btn-box"},[e.hasPermission("sys:menu:save")?n("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.add}},[e._v("新增")]):e._e(),e._v(" "),e.hasPermission("sys:menu:update")?n("el-button",{attrs:{type:"primary",icon:"el-icon-edit-outline"},on:{click:e.update}},[e._v("修改")]):e._e(),e._v(" "),e.hasPermission("sys:menu:delete")?n("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.del}},[e._v("删除")]):e._e()],1),e._v(" "),n("div",{staticClass:"tb-box"},[n("el-table",{ref:"dataTable",staticClass:"init_table",attrs:{data:e.tableListData,"row-style":e.toggleDisplayTr,border:"",stripe:"","max-height":"700","header-cell-style":e.rowClass}},[n("el-table-column",{attrs:{width:"50",center:""},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-radio",{staticClass:"radio",attrs:{label:t.$index},nativeOn:{change:function(n){e.getCurrentRow(t.row)}},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v(" ")])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",width:"90",prop:"menuId",label:"菜单ID"}}),e._v(" "),n("el-table-column",{attrs:{label:"权限名称","min-width":"150","show-overflow-tooltip":"",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("p",{style:"margin-left: "+20*t.row.__level+"px;margin-top:0;margin-bottom:0"},[n("i",{staticClass:"permission_toggleFold",class:e.toggleFoldingClass(t.row),on:{click:function(n){e.toggleFoldingStatus(t.row)}}}),e._v("\n              "+e._s(t.row.name)+"\n            ")])]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",width:"150",prop:"parentName",label:"上级菜单"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",width:"80",label:"图标"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",width:"90",prop:"type",label:"类型"}}),e._v(" "),n("el-table-column",{attrs:{align:"center",width:"90",prop:"orderNum",label:"排序号"}}),e._v(" "),n("el-table-column",{attrs:{align:"left",width:"200",prop:"url",label:"菜单URL","show-overflow-tooltip":!0}}),e._v(" "),n("el-table-column",{attrs:{align:"center",width:"150",label:"授权标识"}})],1)],1),e._v(" "),n("el-dialog",{attrs:{title:"提示",visible:e.delTip,width:"20%",top:"30vh"},on:{"update:visible":function(t){e.delTip=t}}},[n("span",[e._v("确定要删除选中的记录？")]),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.delTip=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.delConfirm}},[e._v("确 定")])],1)])],1),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.switchForm,expression:"switchForm"}],staticClass:"form-section"},[n("div",{staticClass:"panel",domProps:{innerHTML:e._s(e.panelTitle)}}),e._v(" "),n("div",{staticClass:"form-container"},[n("el-form",{ref:"menu",attrs:{model:e.menu,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"类型"}},[n("el-radio-group",{model:{value:e.menu.type,callback:function(t){e.$set(e.menu,"type",t)},expression:"menu.type"}},[n("el-radio",{attrs:{label:"0"}},[e._v("目录")]),e._v(" "),n("el-radio",{attrs:{label:"1"}},[e._v("菜单")]),e._v(" "),n("el-radio",{attrs:{label:"2"}},[e._v("按钮")])],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"菜单名称"}},[n("el-input",{attrs:{placeholder:"菜单名称或按钮名称"},model:{value:e.menu.name,callback:function(t){e.$set(e.menu,"name",t)},expression:"menu.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"上级菜单"}},[n("el-input",{attrs:{readonly:"",placeholder:"一级菜单"},on:{focus:e.showMenuTree},model:{value:e.menu.parentName,callback:function(t){e.$set(e.menu,"parentName",t)},expression:"menu.parentName"}})],1),e._v(" "),2!=e.menu.type?n("el-form-item",{attrs:{label:"菜单URL"}},[n("el-input",{attrs:{placeholder:"菜单URL"},model:{value:e.menu.url,callback:function(t){e.$set(e.menu,"url",t)},expression:"menu.url"}})],1):e._e(),e._v(" "),1==e.menu.type||2==e.menu.type?n("el-form-item",{attrs:{label:"授权标识"}},[n("el-input",{attrs:{placeholder:"多个用逗号分隔，如：user:list,user:create"},model:{value:e.menu.perms,callback:function(t){e.$set(e.menu,"perms",t)},expression:"menu.perms"}})],1):e._e(),e._v(" "),2!=e.menu.type?n("el-form-item",{attrs:{label:"排序号"}},[n("el-input",{model:{value:e.menu.orderNum,callback:function(t){e.$set(e.menu,"orderNum",t)},expression:"menu.orderNum"}})],1):e._e(),e._v(" "),2!=e.menu.type?n("el-form-item",{attrs:{label:"图标"}},[n("el-input",{model:{value:e.menu.icon,callback:function(t){e.$set(e.menu,"icon",t)},expression:"menu.icon"}})],1):e._e(),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确定")]),e._v(" "),n("el-button",{attrs:{type:"warning"},on:{click:e.reback}},[e._v("返回")])],1)],1)],1)]),e._v(" "),n("el-dialog",{attrs:{title:"选择菜单",visible:e.dialogTableVisible,width:"300px",height:"250px"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[n("el-tree",{attrs:{data:e.treeData,props:e.defaultProps},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node;return t.data,n("span",{staticClass:"custom-tree-node"},[n("span",[n("svg-icon",{attrs:{iconClass:i.icon}}),e._v("\n          "+e._s(i.label)+"\n        ")],1)])}}])}),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogTableVisible=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogTableVisible=!1}}},[e._v("确 定")])],1)],1)],1)},[],!1,null,"76ff9ed9",null);p.options.__file="index.vue";t.default=p.exports},bMUu:function(e,t,n){},o5AK:function(e,t,n){"use strict";var i=n("bMUu");n.n(i).a}}]);