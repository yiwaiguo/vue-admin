(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2676"],{"M/WV":function(e,t,a){"use strict";a.r(t);var n=a("14Xm"),i=a.n(n),r=a("D3Ub"),s=a.n(r),o=a("mav0"),l=a("7Qib"),c=localStorage.getItem("token"),u=new Date(new Date((new Date).toLocaleDateString()).setMonth((new Date).getMonth()-1)),d={data:function(){return{title:"查询窗口（点击收起）",labelPosition:"right",q:{loginCode:"",tarOrgCode:"",srcOrgCode:"",status:""},fileList:[],uploadUrl:this.baseURL+"/org/shiftOrg/import",number:1,activeNames:["1"],tableData:[],page:{pageSize:50,total:0,currentPage:1},statusList:[{id:99,name:"通过"},{id:0,name:"待审核"},{id:-1,name:"驳回"}],value:[Object(o.b)(u),Object(o.b)(new Date)],pickerOptions2:{disabledDate:function(e){return e.getTime()>Date.now()-864e4},shortcuts:[{text:"当日",onClick:function(e){var t=Object(o.d)("CURRENTDAY").endTime,a=Object(o.d)("CURRENTDAY").startTime;e.$emit("pick",[a,t])}},{text:"上日",onClick:function(e){var t=Object(o.d)("YESTERODAY").endTime,a=Object(o.d)("YESTERODAY").startTime;e.$emit("pick",[a,t])}},{text:"本周",onClick:function(e){var t=Object(o.d)("CURRENTWEEK").endTime,a=Object(o.d)("CURRENTWEEK").startTime;e.$emit("pick",[a,t])}},{text:"上周",onClick:function(e){var t=Object(o.d)("PREWEEK").endTime,a=Object(o.d)("PREWEEK").startTime;e.$emit("pick",[a,t])}},{text:"本月",onClick:function(e){var t=new Date,a=new Date,n=new Date(a.getFullYear(),a.getMonth(),1);a.setTime(a.getTime()-2592e6),e.$emit("pick",[Object(o.b)(n),Object(o.b)(t)])}},{text:"上月",onClick:function(e){var t=new Date,a=new Date(t.getFullYear(),t.getMonth(),1),n=new Date(t.getFullYear(),t.getMonth()-1,1),i=new Date(a.getTime()-864e5);e.$emit("pick",[Object(o.b)(n),Object(o.b)(i)])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[Object(o.b)(a),Object(o.b)(t)])}}]},myHeaders:{token:c},dialogFormVisible:!1,formLabelWidth:"80px",audit:{}}},filters:{statusFilter:function(e){switch(e){case-1:return"danger";case 0:return"warning";case 99:return"success";default:return""}},formatStatus:function(e){switch(e){case-1:return"驳回";case 0:return"待审核";case 99:return"通过";default:return"-"}}},methods:{hasPermission:function(e){return Object(l.f)(e)},handleChange:function(){this.activeNames.length>0?this.title="查询窗口（收起）":this.title="查询窗口（点击展开）"},selectTime:function(e){return e.map(function(e){return"string"!=typeof e?Object(o.b)(e):e})},query:function(){var e=this;return s()(i.a.mark(function t(){var a,n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.value=e.selectTime(e.value),e.q.startTime=e.value[0]+" 00:00:00",e.q.endTime=e.value[1]+" 23:59:59",a="&loginCode="+e.q.loginCode+"&tarOrgCode="+e.q.tarOrgCode+"&status="+e.q.status+"&startTime="+e.q.startTime+"&endTime="+e.q.endTime+"&srcOrgCode="+e.q.srcOrgCode,t.next=6,e._fetch("/org/shiftOrg/verifyList?limit=50&page=1"+a,{method:"GET"});case 6:0===(n=t.sent).code?(e.tableData=n.page.list,e.page.total=n.page.totalCount,e.page.pageSize=n.page.pageSize):e.$message(n.msg);case 8:case"end":return t.stop()}},t,e)}))()},reset:function(){this.value=[Object(o.b)(u),Object(o.b)(new Date)],this.q={loginCode:"",tarOrgCode:"",srcOrgCode:"",status:"",startTime:this.value[0]+" 00:00:00",endTime:this.value[1]+" 23:59:59"}},download:function(){var e=window.localStorage.getItem("token");this.q.startTime=this.value[0]+" 00:00:00",this.q.endTime=this.value[1]+" 23:59:59";var t="/org/shiftOrg/downVerify?type=org&token="+e+"&startTime="+this.q.startTime+"&endTime="+this.q.endTime+"&status="+this.q.status;fetch(this.baseURL+t,{headers:{"Content-type":"application/json;charset=UTF-8",token:e}}).then(function(e){return e.blob().then(function(e){var t=document.createElement("a"),a=window.URL.createObjectURL(e);t.href=a,t.download="转移机构管理.xls",t.click(),window.URL.revokeObjectURL(a)})})},downloadTemp:function(){var e=window.localStorage.getItem("token"),t="/org/shiftOrg/download?token="+e;fetch(this.baseURL+t,{headers:{"Content-type":"application/json;charset=UTF-8",token:e}}).then(function(e){return e.blob().then(function(e){var t=document.createElement("a"),a=window.URL.createObjectURL(e);t.href=a,t.download="机构转移名单模板.xls",t.click(),window.URL.revokeObjectURL(a)})})},submitUpload:function(){this.$refs.upload.submit()},onExceed:function(){this.$message("每次只能选择一个文件，请删除文件重选")},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},aduitHandle:function(e,t){0===t.status?(this.audit={status:"",remark:"",ids:[],shiftIds:[]},this.audit.ids.push(t.id.toString()),this.audit.shiftIds.push(t.shiftId.toString()),this.dialogFormVisible=!0):this.$message("存在已审核的记录，请检查后重新审核！")},auditConfirm:function(){var e=this;return s()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.audit.status){t.next=3;break}return e.$message("请选择审核意见"),t.abrupt("return");case 3:return t.next=5,e._fetch("/org/shiftOrg/verifyBatch",{method:"POST",body:e.audit});case 5:0===(a=t.sent).code?(e.$message("操作成功"),e.query()):e.$message(a.msg),e.dialogFormVisible=!1;case 8:case"end":return t.stop()}},t,e)}))()},handleSizeChange:function(e){var t=this;return s()(i.a.mark(function a(){var n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t._fetch("/org/shiftOrg/verifyList?limit="+e+"&page="+t.page.currentPage,{method:"GET"});case 2:n=a.sent,t.tableData=n.page.list,t.page.pageSize=e;case 5:case"end":return a.stop()}},a,t)}))()},handleCurrentChange:function(e){var t=this;return s()(i.a.mark(function a(){var n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t._fetch("/org/shiftOrg/verifyList?limit="+t.page.pageSize+"&page="+e,{method:"GET"});case 2:n=a.sent,t.tableData=n.page.list,t.page.currentPage=e;case 5:case"end":return a.stop()}},a,t)}))()},rowClass:function(){return"text-align:center"}}},m=(a("Rhpt"),a("KHd+")),g=Object(m.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-container"},[a("div",{staticClass:"show-box"},[a("div",{staticClass:"query-box"},[a("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:e.title,name:"1"}},[a("div",{staticClass:"query-item btn-item"},[a("el-form",[a("el-form-item",[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:e.uploadUrl,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"file-list":e.fileList,"auto-upload":!1,limit:e.number,"on-exceed":e.onExceed,headers:e.myHeaders}},[a("el-button",{attrs:{slot:"trigger",type:"primary"},slot:"trigger"},[e._v("选取文件")])],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"query-item btn-item"},[a("el-form",[a("el-form-item",[e.hasPermission("shiftorgrecord:import")?a("el-button",{attrs:{type:"success",icon:"el-icon-upload"},on:{click:e.submitUpload}},[e._v("导入名单")]):e._e()],1),e._v(" "),a("el-form-item",[e.hasPermission("shiftorgrecord:template:download")?a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:e.downloadTemp}},[e._v("下载模板")]):e._e()],1)],1)],1),e._v(" "),a("div",{staticClass:"query-item"},[a("el-form",{attrs:{"label-position":e.labelPosition,model:e.q,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"审核状态"}},[a("el-select",{attrs:{placeholder:"请选择状态"},model:{value:e.q.status,callback:function(t){e.$set(e.q,"status",t)},expression:"q.status"}},[a("el-option",{attrs:{value:""}},[e._v("请选择状态")]),e._v(" "),e._l(e.statusList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2)],1)],1)],1),e._v(" "),a("div",{staticClass:"query-item"},[a("el-form",{attrs:{"label-position":e.labelPosition,"label-width":"80px",model:e.q}},[a("el-form-item",{attrs:{label:"提交日期"}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions2},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1)],1)])],1)],1),e._v(" "),a("div",{staticClass:"btn-box"},[e.hasPermission("shiftorgrecord:verify:list")?a("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")]):e._e(),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.reset}},[e._v("重置")]),e._v(" "),e.hasPermission("shiftorgrecord:downVerify")?a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:e.download}},[e._v("导出")]):e._e()],1),e._v(" "),a("div",{staticClass:"tb-box"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-style":e.rowClass,border:"","max-height":"500"}},[a("el-table-column",{attrs:{type:"index",width:"40",align:"center"}}),e._v(" "),e._e(),e._v(" "),e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"用户姓名",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{prop:"loginCode",label:"登录账号",align:"left",width:"250","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"srcOrgCode",label:"源机构编号",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{prop:"tarOrgCode",label:"目标机构编号",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"提交时间",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"verifyTime",label:"审核时间",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"审核状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e._f("statusFilter")(t.row.status)}},[e._v(e._s(e._f("formatStatus")(t.row.status)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",label:"备注",align:"left","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.hasPermission("shiftorgrecord:verifyBatch")?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){e.aduitHandle(t.$index,t.row)}}},[e._v("审核")]):e._e()]}}])})],1)],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.page.currentPage,"page-sizes":[10,30,50],"page-size":e.page.pageSize,total:e.page.total,layout:"total, sizes, prev, pager, next, jumper",background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),e._v(" "),a("el-dialog",{attrs:{title:"转移机构审核",visible:e.dialogFormVisible,width:"25%",top:"30vh"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.audit}},[a("el-form-item",{attrs:{label:"审核意见","label-width":e.formLabelWidth}},[a("el-radio-group",{model:{value:e.audit.status,callback:function(t){e.$set(e.audit,"status",t)},expression:"audit.status"}},[a("el-radio",{attrs:{label:"99"}},[e._v("同意")]),e._v(" "),a("el-radio",{attrs:{label:"-1"}},[e._v("驳回")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"备注信息","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"textarea",placeholder:"备注信息,100字以内",rows:"3"},model:{value:e.audit.remark,callback:function(t){e.$set(e.audit,"remark",t)},expression:"audit.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.auditConfirm}},[e._v("确 定")])],1)],1)],1)},[],!1,null,"0b16bac2",null);g.options.__file="shiftorgverify.vue";t.default=g.exports},Rhpt:function(e,t,a){"use strict";var n=a("YNEo");a.n(n).a},YNEo:function(e,t,a){},mav0:function(e,t,a){"use strict";a.d(t,"b",function(){return d}),a.d(t,"d",function(){return k}),a.d(t,"a",function(){return _}),a.d(t,"c",function(){return C}),a.d(t,"e",function(){return D});var n=new Date,i=0===n.getDay()?6:n.getDay()-1,r=n.getDate(),s=n.getMonth(),o=n.getYear();o+=o<2e3?1900:0;var l=new Date;l.setDate(1),l.setMonth(l.getMonth()-1);var c=l.getYear();c+=c<2e3?1900:0;var u=l.getMonth();function d(e){var t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();return a<10&&(a="0"+a),n<10&&(n="0"+n),t+"-"+a+"-"+n}function m(e){var t=new Date(o,e,1);return(new Date(o,e+1,1)-t)/864e5}var g=d(g=new Date(o,s,r)),p=d(p=new Date(o,s,r-1)),f=d(f=new Date(o,s,r-i)),h=(d(new Date(o,s,r+(6-i))),d(h=new Date(o,s,r-i-7))),b=d(b=new Date(o,s,r+(6-i-7))),v=d(v=new Date(o,s,1)),w=(d(new Date(o,s,m(s))),d(w=new Date(c,u,1))),T=d(T=new Date(c,u,m(u)));function k(e){var t={startTime:"",endTime:""};switch(e){case"CURRENTDAY":return t.startTime=g,t.endTime=g,t;case"YESTERODAY":return t.startTime=p,t.endTime=p,t;case"CURRENTWEEK":return t.startTime=f,t.endTime=g,t;case"PREWEEK":return t.startTime=h,t.endTime=b,t;case"CURRENTMONTH":return t.startTime=v,t.endTime=g,t;case"PREMONTH":return t.startTime=w,t.endTime=T,t;default:return t}}function _(e){var t=new Date(e),a=t.getMonth()+1,n=t.getDate(),i=t.getHours(),r=t.getMinutes(),s=t.getSeconds();return a>=1&&a<=9&&(a="0"+a),n>=0&&n<=9&&(n="0"+n),i>=0&&i<=9&&(i="0"+i),r>=0&&r<=9&&(r="0"+r),s>=0&&s<=9&&(s="0"+s),t.getFullYear()+"-"+a+"-"+n+" "+i+":"+r+":"+s}function C(e){e.split("");return e.substring(0,4)+"-"+e.substring(4,6)+"-"+e.substring(6,8)+" "+e.substring(9,11)+":"+e.substring(11,13)+":"+e.substring(13,15)}function D(e,t){if(""!=e&&""!=t){e=new Date(e.replace(/-/g,"/"));var a=(t=new Date(t.replace(/-/g,"/"))).getTime()-e.getTime();return parseInt(a/864e5)>60||void 0}this.$message("时间不能为空")}}}]);