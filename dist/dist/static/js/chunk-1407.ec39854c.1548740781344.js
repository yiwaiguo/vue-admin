(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1407"],{H4SO:function(e,t,a){"use strict";var n=a("tgMR");a.n(n).a},mav0:function(e,t,a){"use strict";a.d(t,"b",function(){return m}),a.d(t,"d",function(){return y}),a.d(t,"a",function(){return k}),a.d(t,"c",function(){return _}),a.d(t,"e",function(){return D});var n=new Date,i=0===n.getDay()?6:n.getDay()-1,r=n.getDate(),l=n.getMonth(),s=n.getYear();s+=s<2e3?1900:0;var o=new Date;o.setDate(1),o.setMonth(o.getMonth()-1);var c=o.getYear();c+=c<2e3?1900:0;var u=o.getMonth();function m(e){var t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();return a<10&&(a="0"+a),n<10&&(n="0"+n),t+"-"+a+"-"+n}function d(e){var t=new Date(s,e,1);return(new Date(s,e+1,1)-t)/864e5}var p=m(p=new Date(s,l,r)),f=m(f=new Date(s,l,r-1)),b=m(b=new Date(s,l,r-i)),g=(m(new Date(s,l,r+(6-i))),m(g=new Date(s,l,r-i-7))),h=m(h=new Date(s,l,r+(6-i-7))),v=m(v=new Date(s,l,1)),w=(m(new Date(s,l,d(l))),m(w=new Date(c,u,1))),T=m(T=new Date(c,u,d(u)));function y(e){var t={startTime:"",endTime:""};switch(e){case"CURRENTDAY":return t.startTime=p,t.endTime=p,t;case"YESTERODAY":return t.startTime=f,t.endTime=f,t;case"CURRENTWEEK":return t.startTime=b,t.endTime=p,t;case"PREWEEK":return t.startTime=g,t.endTime=h,t;case"CURRENTMONTH":return t.startTime=v,t.endTime=p,t;case"PREMONTH":return t.startTime=w,t.endTime=T,t;default:return t}}function k(e){var t=new Date(e),a=t.getMonth()+1,n=t.getDate(),i=t.getHours(),r=t.getMinutes(),l=t.getSeconds();return a>=1&&a<=9&&(a="0"+a),n>=0&&n<=9&&(n="0"+n),i>=0&&i<=9&&(i="0"+i),r>=0&&r<=9&&(r="0"+r),l>=0&&l<=9&&(l="0"+l),t.getFullYear()+"-"+a+"-"+n+" "+i+":"+r+":"+l}function _(e){e.split("");return e.substring(0,4)+"-"+e.substring(4,6)+"-"+e.substring(6,8)+" "+e.substring(9,11)+":"+e.substring(11,13)+":"+e.substring(13,15)}function D(e,t){if(""!=e&&""!=t){e=new Date(e.replace(/-/g,"/"));var a=(t=new Date(t.replace(/-/g,"/"))).getTime()-e.getTime();return parseInt(a/864e5)>60||void 0}this.$message("时间不能为空")}},tgMR:function(e,t,a){},wI3O:function(e,t,a){"use strict";a.r(t);var n=a("14Xm"),i=a.n(n),r=a("D3Ub"),l=a.n(r),s=a("mav0"),o=a("7Qib"),c=window.localStorage.getItem("keyword"),u=new Date(new Date((new Date).toLocaleDateString()).setMonth((new Date).getMonth()-1)),m={data:function(){return{title:"查询窗口（点击收起）",maxHeight:"550",labelPosition:"right",keyword:c,list:{},q:{orderCode:"",userName:"",status:"",startTime:"",endTime:"",timeType:""},activeNames:["1"],tableData:[],page:{pageSize:50,total:0,currentPage:1},value:[Object(s.b)(u),Object(s.b)(new Date)],pickerOptions2:{disabledDate:function(e){return e.getTime()>Date.now()-864e4},shortcuts:[{text:"当日",onClick:function(e){var t=Object(s.d)("CURRENTDAY").endTime,a=Object(s.d)("CURRENTDAY").startTime;e.$emit("pick",[a,t])}},{text:"上日",onClick:function(e){var t=Object(s.d)("YESTERODAY").endTime,a=Object(s.d)("YESTERODAY").startTime;e.$emit("pick",[a,t])}},{text:"本周",onClick:function(e){var t=Object(s.d)("CURRENTWEEK").endTime,a=Object(s.d)("CURRENTWEEK").startTime;e.$emit("pick",[a,t])}},{text:"上周",onClick:function(e){var t=Object(s.d)("PREWEEK").endTime,a=Object(s.d)("PREWEEK").startTime;e.$emit("pick",[a,t])}},{text:"本月",onClick:function(e){var t=new Date,a=new Date,n=new Date(a.getFullYear(),a.getMonth(),1);a.setTime(a.getTime()-2592e6),e.$emit("pick",[Object(s.b)(n),Object(s.b)(t)])}},{text:"上月",onClick:function(e){var t=new Date,a=new Date(t.getFullYear(),t.getMonth(),1),n=new Date(t.getFullYear(),t.getMonth()-1,1),i=new Date(a.getTime()-864e5);e.$emit("pick",[Object(s.b)(n),Object(s.b)(i)])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[Object(s.b)(a),Object(s.b)(t)])}}]},form:{},dialogFormVisible:!1,multipleSelection:{},url:""}},filters:{typeFilter:function(e){return{0:"info",1:"info",2:"info"}[e]},formatType:function(e){return{0:"初审",1:"复审",2:"三审"}[e]},statusFilter:function(e){return{"-1":"danger",0:"warning",1:"info",2:"info",99:"success"}[e]},formatStatus:function(e){return{"-1":"驳回",0:"审核中",1:"复审",2:"三审",99:"通过"}[e]}},methods:{hasPermission:function(e){return Object(o.f)(e)},handleChange:function(){this.activeNames.length>0?(this.title="查询窗口（收起）",this.maxHeight="550"):(this.title="查询窗口（点击展开）",this.maxHeight="700")},selectTime:function(e){return e.map(function(e){return"string"!=typeof e?Object(s.b)(e):e})},query:function(){var e=this;return l()(i.a.mark(function t(){var a,n;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.value=e.selectTime(e.value),e.q.startTime=e.value[0]+" 00:00:00",e.q.endTime=e.value[1]+" 23:59:59",a="&orderCode="+e.q.orderCode+"&userName="+e.q.userName+"&status="+e.q.status+"&startTime="+e.q.startTime+"&endTime="+e.q.endTime+"&timeType="+e.q.timeType,t.next=6,e._fetch("/refundapply/list?type=0&limit=50&page=1"+a,{method:"GET"});case 6:0===(n=t.sent).code?(e.tableData=n.page.list,e.page.total=n.page.totalCount,e.page.pageSize=n.page.pageSize):console.log(n.msg);case 8:case"end":return t.stop()}},t,e)}))()},reset:function(){this.value=[Object(s.b)(u),Object(s.b)(new Date)],this.q={orderCode:"",userName:"",status:"",startTime:this.value[0]+" 00:00:00",endTime:this.value[1]+" 23:59:59",timeType:""}},checkup:function(){this.multipleSelection.id?0==this.multipleSelection.status?(this.form=this.multipleSelection,this.dialogFormVisible=!0):this.$message("不可审核"):this.$message("请选择一条记录")},download:function(){var e=window.localStorage.getItem("token");this.q.startTime=this.value[0]+" 00:00:00",this.q.endTime=this.value[1]+" 23:59:59",this.url="/refundapply/download?token="+e+"&startTime="+this.q.startTime+"&endTime="+this.q.endTime+"&page="+this.page.currentPage+"&limit="+this.page.pageSize,fetch(this.baseURL+this.url,{headers:{"Content-type":"application/json;charset=UTF-8",token:e}}).then(function(e){return e.blob().then(function(e){var t=document.createElement("a"),a=window.URL.createObjectURL(e);t.href=a,t.download="退差价审核.xls",t.click(),window.URL.revokeObjectURL(a)})})},_auditSubmit:function(){this.form.status?(this.form.id=this.multipleSelection.id,this.form.type=this.multipleSelection.type,this.form.vId=this.multipleSelection.vId,this.submitHandle()):this.$message("请选择审核意见")},submitHandle:function(){var e=this;return l()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e._fetch("/refundapply/commitApplyFirst",{method:"POST",body:e.form});case 2:0===(a=t.sent).code?(e.$message("操作成功"),e.dialogFormVisible=!1,e.query()):e.$message(a.msg);case 4:case"end":return t.stop()}},t,e)}))()},select:function(e,t){e.length>1&&e.shift(),this.multipleSelection=t},handleSelectionChange:function(e){e.length>2&&(this.$message("请选择一条记录"),this.$refs.dataTable.clearSelection())},getRowData:function(e){this.$refs.dataTable.toggleRowSelection(e),this.multipleSelection=e},handleSizeChange:function(e){var t=this;return l()(i.a.mark(function a(){var n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t._fetch("/refundapply/list?limit="+e+"&page="+t.page.currentPage,{method:"GET"});case 2:n=a.sent,t.tableData=n.page.list,t.page.pageSize=e;case 5:case"end":return a.stop()}},a,t)}))()},handleCurrentChange:function(e){var t=this;return l()(i.a.mark(function a(){var n;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t._fetch("/refundapply/list?limit="+t.page.pageSize+"&page="+e,{method:"GET"});case 2:n=a.sent,t.tableData=n.page.list,t.page.currentPage=e;case 5:case"end":return a.stop()}},a,t)}))()},rowClass:function(){return"text-align:center"}},created:function(){this.query()}},d=(a("H4SO"),a("KHd+")),p=Object(d.a)(m,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-container"},[a("div",{staticClass:"show-box"},[a("div",{staticClass:"query-box"},[a("el-collapse",{on:{change:e.handleChange},model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:e.title,name:"1"}},[a("div",{staticClass:"query-item"},[a("el-form",{attrs:{"label-position":e.labelPosition,"label-width":"80px",model:e.q}},[a("el-form-item",{attrs:{label:"订单号"}},[a("el-input",{attrs:{placeholder:"请输入订单号"},model:{value:e.q.orderCode,callback:function(t){e.$set(e.q,"orderCode",t)},expression:"q.orderCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户姓名"}},[a("el-input",{attrs:{placeholder:"请输入用户姓名"},model:{value:e.q.userName,callback:function(t){e.$set(e.q,"userName",t)},expression:"q.userName"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"query-item"},[a("el-form",{attrs:{"label-position":e.labelPosition,"label-width":"80px",model:e.q}},[a("el-form-item",{attrs:{label:"审核状态"}},[a("el-select",{attrs:{placeholder:"请选择审核状态"},model:{value:e.q.status,callback:function(t){e.$set(e.q,"status",t)},expression:"q.status"}},[a("el-option",{attrs:{label:"区域一",value:"shanghai"}})],1)],1)],1)],1),e._v(" "),a("div",{staticClass:"query-item"},[a("el-form",{attrs:{"label-position":e.labelPosition,"label-width":"80px",model:e.q}},[a("el-form-item",{attrs:{label:"日期查询"}},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions2},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1)],1)])],1)],1),e._v(" "),a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{type:"primary"},on:{click:e.query}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.reset}},[e._v("重置")]),e._v(" "),e.hasPermission("refundapply:download")?a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:e.download}},[e._v("导出")]):e._e(),e._v(" "),e.hasPermission("refundapply:commitApply:first")?a("el-button",{attrs:{type:"danger"},on:{click:e.checkup}},[e._v("审查")]):e._e()],1),e._v(" "),a("div",{staticClass:"tb-box"},[a("el-table",{ref:"dataTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-style":e.rowClass,border:"","max-height":e.maxHeight},on:{select:e.select,"row-click":e.getRowData,"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"index",width:"40",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{type:"selection",width:"45",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"orderCode",label:"订单号",width:"200",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"用户姓名",width:"120",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"审核类型",align:"left",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e._f("typeFilter")(t.row.type)}},[e._v(e._s(e._f("formatType")(t.row.type)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"审核状态",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e._f("statusFilter")(t.row.status)}},[e._v(e._s(e._f("formatStatus")(t.row.status)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"verifyName",label:"审核人",align:"left",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"orderPrice",label:"订单金额",align:"right",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"refundTotal",label:"退差价总额",align:"right",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"refundMoney",label:"退差价额",align:"right"}}),e._v(" "),a("el-table-column",{attrs:{prop:"refundBean",label:"退差"+e.keyword+"数量",align:"right",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"applyTime",label:"申请时间",align:"center",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"verifyTime",label:"审核时间",align:"center",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"remarks",label:"备注信息",align:"left",width:"250"}})],1)],1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.page.currentPage,"page-sizes":[10,30,50],"page-size":e.page.pageSize,total:e.page.total,layout:"total, sizes, prev, pager, next, jumper",background:""},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"退差价审核",visible:e.dialogFormVisible,width:"25%",top:"30vh"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.form,"label-position":"left"}},[a("el-form-item",{attrs:{label:"订单号","label-width":"100px"}},[a("el-input",{attrs:{"auto-complete":"off",disabled:""},model:{value:e.form.orderCode,callback:function(t){e.$set(e.form,"orderCode",t)},expression:"form.orderCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"退差价额","label-width":"100px"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.refundMoney,callback:function(t){e.$set(e.form,"refundMoney",t)},expression:"form.refundMoney"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"退差"+e.keyword+"数量","label-width":"100px"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.refundBean,callback:function(t){e.$set(e.form,"refundBean",t)},expression:"form.refundBean"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"退差价总额","label-width":"100px"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.refundTotal,callback:function(t){e.$set(e.form,"refundTotal",t)},expression:"form.refundTotal"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注信息","label-width":"100px"}},[a("el-input",{attrs:{type:"textarea",disabled:""},model:{value:e.form.remarks,callback:function(t){e.$set(e.form,"remarks",t)},expression:"form.remarks"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"审核意见","label-width":"100px",disabled:""}},[a("el-radio",{attrs:{label:"1"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[e._v("同意")]),e._v(" "),a("el-radio",{attrs:{label:"-1"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[e._v("驳回")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"warning"},on:{click:e._auditSubmit}},[e._v("提 交")]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),a("iframe",{attrs:{id:"downloadOne",name:"iframe",height:"0px",width:"0px"}})],1)])},[],!1,null,"624cb20b",null);p.options.__file="refundapply.vue";t.default=p.exports}}]);