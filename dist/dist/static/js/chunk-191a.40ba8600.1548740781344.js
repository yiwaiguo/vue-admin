(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-191a"],{EOpL:function(t,a,e){},Rf8m:function(t,a,e){"use strict";e.r(a);var o=e("14Xm"),l=e.n(o),i=e("D3Ub"),s=e.n(i),r=e("7Qib"),n=localStorage.getItem("adminEd"),c={data:function(){return{q:{orgId:""},tableData:[],multipleSelection:[],page:{pageSize:10,total:1,currentPage:1},isAdmin:!1,switchForm:!1,subTip:!1,optData:{},panelTitle:"",orgIds:[],bankCodes:[],flag:!1,applyData:{},dialogFormVisible:!1,formLabelWidth:"80px",pswTip:!1,loginCode:"",wdPsw:""}},created:function(){this.getOrgIds(),this.getBankCodes(),this.isAdmin="true"===n},methods:{hasPermission:function(t){return Object(r.f)(t)},query:function(){var t=this;return s()(l.a.mark(function a(){var e;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!t.isAdmin){a.next=4;break}if(!Object(r.g)(t.q.orgId)){a.next=4;break}return t.$message("机构名称不能为空"),a.abrupt("return");case 4:return a.next=6,t._fetch("/corporate/bankcard/list?limit=50&page=1&orgId="+t.q.orgId,{method:"GET"});case 6:0===(e=a.sent).code?t.tableData=e.page:t.$message(e.msg);case 8:case"end":return a.stop()}},a,t)}))()},clearHandle:function(){this.formInline.key=""},add:function(){this.switchForm=!0,this.panelTitle="绑卡",this.optData={},this.flag=!0},getOrgIds:function(){var t=this;return s()(l.a.mark(function a(){var e;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t._fetch("/corporate/bankcard/getOrgIds",{method:"GET"});case 2:e=a.sent,t.loginCode=e.data[0].loginCode,t.orgIds=e.data;case 5:case"end":return a.stop()}},a,t)}))()},getBankCodes:function(){var t=this;return s()(l.a.mark(function a(){var e;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t._fetch("/corporate/bankcard/getBankCodes",{method:"GET"});case 2:e=a.sent,t.bankCodes=e.data;case 4:case"end":return a.stop()}},a,t)}))()},updateHandle:function(t,a){this.optData=a,this.optData.id=a.userUid,this.switchForm=!0,this.panelTitle="解绑",this.flag=!1},onSubmit:function(){var t=this;if(!this.validator()){this.bankCodes.map(function(a){t.optData.bankCode==a.bankCode&&(t.optData.bankName=a.bankName)});var a=null==this.optData.id?"/corporate/bankcard/bindcard":"/corporate/bankcard/unbindcard";this.addUser(a)}},addUser:function(t){var a=this;return s()(l.a.mark(function e(){var o;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a._fetch(t,{method:"POST",body:a.optData});case 2:0===(o=e.sent).code?(a.$message("操作成功"),a.query(),a.switchForm=!1):a.$message(o.msg);case 4:case"end":return e.stop()}},e,a)}))()},reback:function(){this.switchForm=!1},withdrawl:function(t,a){var e=this;this.applyData.bankCardSerialNo=a.bindId,this.applyData.userUid=a.userUid,this.wdPsw="",this.pswTip=!0,this.orgIds.forEach(function(t){e.q.orgId==t.orgId&&(e.loginCode=t.loginCode)})},wdConfirm:function(){var t=this;return s()(l.a.mark(function a(){var e,o;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!Object(r.g)(t.wdPsw)){a.next=3;break}return t.$message("提现密码不能为空"),a.abrupt("return");case 3:if(/^[a-zA-Z0-9]{6,20}$/.test(t.wdPsw)){a.next=6;break}return t.$message("密码格式不对"),a.abrupt("return");case 6:return e={loginCode:t.loginCode,password:t.wdPsw},a.next=9,t._fetch("/corporate/bankcard/getAllowWithdrawal",{method:"POST",body:e});case 9:200===(o=a.sent).rc?(t.dialogFormVisible=!0,t.pswTip=!1,t.applyData.allowWithdrawal=o.data[0].amWithdrawable):t.$message(o.msg);case 11:case"end":return a.stop()}},a,t)}))()},withdrawConfirm:function(){if(!this.validator2()){var t=(100*parseFloat(this.applyData.amt)).toFixed(0);this.applyData.withdrawlAmt=t.toString(),this.subConfirm()}},subConfirm:function(){var t=this;return s()(l.a.mark(function a(){var e;return l.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return console.log(123),a.next=3,t._fetch("//corporate/withdrawal/preapplication",{method:"POST",body:t.applyData});case 3:0===(e=a.sent).code?(t.$message("操作成功"),t.query(),t.pswTip=!1,t.dialogFormVisible=!1):t.$message(e.msg),t.subTip=!1;case 6:case"end":return a.stop()}},a,t)}))()},validator:function(){if(!this.flag&&Object(r.g)(this.optData.userUid))return this.$message("用户标识不能为空"),!0;if(!/^[A-Za-z0-9]+$/.test(this.optData.bankAccountNo))return this.$message("请输入正确的银行卡号"),!0;if(Object(r.g)(this.optData.bankAccountName))return this.$message("公司名称不能为空"),!0;if(Object(r.g)(this.optData.province))return this.$message("所属省不能为空"),!0;if(Object(r.g)(this.optData.city))return this.$message("所属市不能为空"),!0;if(this.flag){if(Object(r.g)(this.optData.bankCode))return this.$message("银行名称不能为空"),!0;if(Object(r.g)(this.optData.orgId))return this.$message("机构名称不能为空"),!0}return Object(r.g)(this.optData.bankAccountNo)?(this.$message("银行卡号不能为空"),!0):Object(r.g)(this.optData.bankAccountAddress)?(this.$message("银行卡支行地址不能为空"),!0):void 0},validator2:function(){return Object(r.g)(this.applyData.amt)?(this.$message("提现金额不能为空"),!0):this.applyData.amt<5?(this.$message("提现金额不能小于5元"),!0):/^[0-9]+([.]{1}[0-9]{1,2})?$/.test(this.applyData.amt.trim())?parseFloat(this.applyData.amt)?this.applyData.amt>this.applyData.allowWithdrawal?(this.$message("提现金额不能大于可出金额"),!0):Object(r.g)(this.applyData.remark)?(this.$message("备注信息不能为空"),!0):void 0:(this.$message("提现金额不能为0"),!0):(this.$message("输入金额只允许两位小数"),this.applyData.amt="",this.this.$messageTip=!1,this.this.$messageTip=!0,!0)},rowClass:function(){return"text-align:center"}}},d=(e("qQes"),e("KHd+")),p=Object(d.a)(c,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"page-container"},[e("div",{directives:[{name:"show",rawName:"v-show",value:!t.switchForm,expression:"!switchForm"}],staticClass:"show-box"},[e("div",{staticClass:"query-box"},[e("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.q}},[t.hasPermission("corporate:bankcard:getOrgIds")?e("el-form-item",{staticClass:"form-item",attrs:{label:"机构名称"}},[e("el-select",{attrs:{placeholder:"选择机构名称"},model:{value:t.q.orgId,callback:function(a){t.$set(t.q,"orgId",a)},expression:"q.orgId"}},t._l(t.orgIds,function(t){return e("el-option",{key:t.orgCode,attrs:{label:t.orgName,value:t.orgId}})}))],1):t._e(),t._v(" "),e("el-form-item",{staticClass:"form-item"},[t.hasPermission("corporate:bankcard:list")?e("el-button",{attrs:{type:"info"},on:{click:t.query}},[t._v("查询")]):t._e()],1)],1)],1),t._v(" "),e("div",{staticClass:"btn-box"},[t.hasPermission("corporate:bankcard:bindcard")?e("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.add}},[t._v("绑卡")]):t._e()],1),t._v(" "),e("el-dialog",{attrs:{title:"提现密码",visible:t.pswTip,width:"20%",top:"30vh"},on:{"update:visible":function(a){t.pswTip=a}}},[e("el-form",[e("el-form-item",{attrs:{label:"loginCode","label-width":t.formLabelWidth}},[e("el-input",{attrs:{placeholder:"loginCode",disabled:""},model:{value:t.loginCode,callback:function(a){t.loginCode=a},expression:"loginCode"}})],1),t._v(" "),e("el-form-item",{staticClass:"wd-form",attrs:{label:"密码","label-width":t.formLabelWidth}},[e("el-input",{attrs:{placeholder:"请输入6-20字母数字密码"},model:{value:t.wdPsw,callback:function(a){t.wdPsw=a},expression:"wdPsw"}})],1)],1),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.wdConfirm}},[t._v("确 定")]),t._v(" "),e("el-button",{on:{click:function(a){t.pswTip=!1}}},[t._v("取 消")])],1)],1),t._v(" "),e("el-dialog",{attrs:{title:"提现",visible:t.dialogFormVisible,width:"25%",top:"30vh",center:""},on:{"update:visible":function(a){t.dialogFormVisible=a}}},[e("el-form",{staticClass:"alertBox",attrs:{model:t.applyData}},[e("el-form-item",{attrs:{label:"用户标识","label-width":t.formLabelWidth}},[e("el-input",{attrs:{placeholder:"用户标识",disabled:""},model:{value:t.applyData.userUid,callback:function(a){t.$set(t.applyData,"userUid",a)},expression:"applyData.userUid"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"绑定标识","label-width":t.formLabelWidth}},[e("el-input",{attrs:{placeholder:"绑定标识",disabled:""},model:{value:t.applyData.bankCardSerialNo,callback:function(a){t.$set(t.applyData,"bankCardSerialNo",a)},expression:"applyData.bankCardSerialNo"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"可出金额","label-width":t.formLabelWidth}},[e("el-input",{attrs:{placeholder:"可出金额",disabled:""},model:{value:t.applyData.allowWithdrawal,callback:function(a){t.$set(t.applyData,"allowWithdrawal",a)},expression:"applyData.allowWithdrawal"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"提现金额","label-width":t.formLabelWidth}},[e("el-input",{attrs:{placeholder:"输入金额不能小于5元（允许两位小数）",maxlength:"11"},model:{value:t.applyData.amt,callback:function(a){t.$set(t.applyData,"amt",a)},expression:"applyData.amt"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"备注信息","label-width":t.formLabelWidth}},[e("el-input",{attrs:{type:"textarea",placeholder:"备注信息"},model:{value:t.applyData.remark,callback:function(a){t.$set(t.applyData,"remark",a)},expression:"applyData.remark"}})],1)],1),t._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.withdrawConfirm}},[t._v("确 定")]),t._v(" "),e("el-button",{on:{click:function(a){t.dialogFormVisible=!1}}},[t._v("取 消")])],1)],1),t._v(" "),e("el-dialog",{attrs:{title:"提示",visible:t.subTip,width:"20%",top:"30vh"},on:{"update:visible":function(a){t.subTip=a}}},[e("span",[t._v("确定提交？")]),t._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.subConfirm}},[t._v("确 定")]),t._v(" "),e("el-button",{on:{click:function(a){t.subTip=!1}}},[t._v("取 消")])],1)]),t._v(" "),e("div",{staticClass:"tb-box"},[e("el-table",{ref:"dataTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,"header-cell-style":t.rowClass,border:"","max-height":"700"}},[e("el-table-column",{attrs:{type:"index",width:"40",align:"center"}}),t._v(" "),e("el-table-column",{attrs:{prop:"bindId",label:"绑定标识",align:"left",width:"200"}}),t._v(" "),e("el-table-column",{attrs:{prop:"userUid",label:"用户标识",align:"left",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{prop:"bankAccountType",label:"账号类型",align:"left",width:"120"}}),t._v(" "),e("el-table-column",{attrs:{prop:"channelType",label:"渠道编号",align:"left",width:"120"}}),t._v(" "),e("el-table-column",{attrs:{prop:"bankAccountName",label:"公司名称",align:"left",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{prop:"province",label:"所属省",align:"left",width:"120"}}),t._v(" "),e("el-table-column",{attrs:{prop:"city",label:"所属市",align:"left",width:"120"}}),t._v(" "),e("el-table-column",{attrs:{prop:"bankName",label:"银行卡名称",align:"left",width:"120"}}),t._v(" "),e("el-table-column",{attrs:{prop:"bankAccountNo",label:"银行卡号",align:"left",width:"200"}}),t._v(" "),e("el-table-column",{attrs:{prop:"bankAccountAddress",label:"银行卡支行地址",align:"left",width:"200"}}),t._v(" "),e("el-table-column",{attrs:{prop:"",label:"操作",align:"center",width:"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[t.hasPermission("corporate:bankcard:unbindcard")?e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){t.updateHandle(a.$index,a.row)}}},[t._v("解绑")]):t._e(),t._v(" "),t.hasPermission("corporate:withdrawal:apply")?e("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.isAdmin,expression:"!isAdmin"}],attrs:{type:"primary",size:"mini"},on:{click:function(e){t.withdrawl(a.$index,a.row)}}},[t._v("提现")]):t._e()]}}])})],1)],1),t._v(" "),e("div",{staticClass:"block"},[e("el-pagination",{attrs:{"current-page":t.page.currentPage,"page-sizes":[10,30,50],"page-size":t.page.pageSize,total:t.page.total,layout:"total, sizes, prev, pager, next, jumper",background:""}})],1)],1),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.switchForm,expression:"switchForm"}],staticClass:"form-section"},[e("div",{staticClass:"panel",domProps:{innerHTML:t._s(t.panelTitle)}}),t._v(" "),e("div",{staticClass:"form-container"},[e("el-form",{ref:"config",attrs:{model:t.optData,"label-width":"120px"}},[e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!t.flag,expression:"!flag"}],attrs:{label:"用户标识"}},[e("el-input",{attrs:{placeholder:"用户标识",disabled:!t.flag},model:{value:t.optData.userUid,callback:function(a){t.$set(t.optData,"userUid",a)},expression:"optData.userUid"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"公司名称"}},[e("el-input",{attrs:{placeholder:"公司名称",disabled:!t.flag},model:{value:t.optData.bankAccountName,callback:function(a){t.$set(t.optData,"bankAccountName",a)},expression:"optData.bankAccountName"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"所属省"}},[e("el-input",{attrs:{placeholder:"所属省",disabled:!t.flag},model:{value:t.optData.province,callback:function(a){t.$set(t.optData,"province",a)},expression:"optData.province"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"所属市"}},[e("el-input",{attrs:{placeholder:"所属市",disabled:!t.flag},model:{value:t.optData.city,callback:function(a){t.$set(t.optData,"city",a)},expression:"optData.city"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"银行名称"}},[e("el-select",{attrs:{placeholder:"选择银行名称",disabled:!t.flag},model:{value:t.optData.bankCode,callback:function(a){t.$set(t.optData,"bankCode",a)},expression:"optData.bankCode"}},t._l(t.bankCodes,function(t){return e("el-option",{key:t.bankCode,attrs:{label:t.bankName,value:t.bankCode}})}))],1),t._v(" "),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.flag,expression:"flag"}],attrs:{label:"机构名称"}},[e("el-select",{attrs:{placeholder:"选择机构名称",disabled:!t.flag},model:{value:t.optData.orgId,callback:function(a){t.$set(t.optData,"orgId",a)},expression:"optData.orgId"}},t._l(t.orgIds,function(t){return e("el-option",{key:t.orgId,attrs:{label:t.orgName,value:t.orgId}})}))],1),t._v(" "),e("el-form-item",{attrs:{label:"银行卡号"}},[e("el-input",{attrs:{placeholder:"银行卡号",disabled:!t.flag},model:{value:t.optData.bankAccountNo,callback:function(a){t.$set(t.optData,"bankAccountNo",a)},expression:"optData.bankAccountNo"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"银行卡支行地址"}},[e("el-input",{attrs:{placeholder:"银行卡支行地址",disabled:!t.flag},model:{value:t.optData.bankAccountAddress,callback:function(a){t.$set(t.optData,"bankAccountAddress",a)},expression:"optData.bankAccountAddress"}})],1),t._v(" "),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("提交")]),t._v(" "),e("el-button",{attrs:{type:"warning"},on:{click:t.reback}},[t._v("返回")])],1)],1)],1)])])},[],!1,null,"7fc900a2",null);p.options.__file="corporatebankcard.vue";a.default=p.exports},qQes:function(t,a,e){"use strict";var o=e("EOpL");e.n(o).a}}]);